<!DOCTYPE html>
<html>
<head>
    <title>Tower Coverage Dashboard</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet"
          href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <style>
        #map {
            height: 90vh;
            width: 100%;
        }

        body {
            font-family: Arial, sans-serif;
        }

        h2 {
            text-align: center;
        }
    </style>
</head>

<body>

<h2>Tower Structure & Coverage – Kuala Paka</h2>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- KML Plugin -->
<script src="https://unpkg.com/leaflet-omnivore/leaflet-omnivore.min.js"></script>

<script>

// =========================
// 1. Create Map
// =========================

var map = L.map('map').setView([4.71, 103.39], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data © OpenStreetMap'
}).addTo(map);


// =========================
// 2. Load Coverage KML
// =========================

omnivore.kml('pcs kuala paka v2.kml')
    .on('ready', function () {
        map.fitBounds(this.getBounds());
    })
    .addTo(map);


// =========================
// 3. Load Tower CSV
// =========================

fetch('tower_locations.csv')
.then(response => response.text())
.then(data => {

    var rows = data.split("\n");

    for (var i = 1; i < rows.length; i++) {

        var cols = rows[i].split(",");

        if (cols.length >= 3) {

            var towerName = cols[0];
            var lat = parseFloat(cols[1]);
            var lon = parseFloat(cols[2]);

            // Example extra info
            var district = "Kuala Paka";
            var complaint = "No complaint";
            var status = "Good Coverage";

            var marker = L.marker([lat, lon]).addTo(map);

            marker.bindPopup(
                "<b>Tower:</b> " + towerName + "<br>" +
                "<b>District:</b> " + district + "<br>" +
                "<b>Complaint:</b> " + complaint + "<br>" +
                "<b>Status:</b> " + status
            );
        }
    }

});

</script>

</body>
</html>
